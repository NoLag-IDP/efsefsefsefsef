local function RunInvisibleSteal()
    if hasRun then return end
    hasRun = true

    local plotsFolder = Workspace:FindFirstChild("Plots")
    local myBase
    local duplicatedBaseDone = false
    local clonedPodiumsDone = false
    local badPlayers = {"gagst34l3r", "13sabst34l3r", "TDNMTM_7", "Xerpier728", "light1234005"}

    -- Functions: FindBase, Duplicate, PreserveAnimations, CleanHitboxes, DeleteModels, RemoveGui
    local function FindMyBase()
        if not plotsFolder then return nil end
        for _, plot in ipairs(plotsFolder:GetChildren()) do
            local sign = plot:FindFirstChild("PlotSign")
            if sign and sign:FindFirstChild("YourBase") then
                if sign.YourBase.Enabled then
                    return plot
                end
            end
        end
        return nil
    end

    local function PreserveAnimations(original, clone)
        for _, desc in ipairs(original:GetDescendants()) do
            if desc:IsA("Animator") then
                local cloneAnim = clone:FindFirstChildWhichIsA("Animator", true)
                if cloneAnim then
                    for _, track in ipairs(desc:GetPlayingAnimationTracks()) do
                        local anim = Instance.new("Animation")
                        anim.AnimationId = track.Animation.AnimationId
                        cloneAnim:LoadAnimation(anim):Play()
                    end
                end
            end
        end
    end

    local function DuplicateBaseModelsOnce(base)
        if duplicatedBaseDone or not base then return end
        for _, obj in ipairs(base:GetChildren()) do
            if obj:IsA("Model") and obj.Name ~= "FriendPanel" and obj.Name ~= "AnimalPodiums" then
                local clone = obj:Clone()
                clone.Name = obj.Name .. "_clone"
                clone.Parent = base
                PreserveAnimations(obj, clone)
                obj:Destroy()
            end
        end
        duplicatedBaseDone = true
    end

    local function DuplicateAnimalPodiumsOnce(base)
        if clonedPodiumsDone or not base then return end
        local podiums = base:FindFirstChild("AnimalPodiums")
        if podiums then
            for _, p in ipairs(podiums:GetChildren()) do
                if p:IsA("Model") then
                    local c = p:Clone()
                    c.Name = p.Name .. "_clone"
                    c.Parent = podiums
                    PreserveAnimations(p, c)
                    p:Destroy()
                end
            end
            clonedPodiumsDone = true
        end
    end

    local function cleanHitboxes(base)
        if not base then return end
        local purchases = base:FindFirstChild("Purchases")
        if not purchases then return end
        local function process(target)
            if not target then return end
            for _, obj in ipairs(target:GetDescendants()) do
                if string.lower(obj.Name) == "hitbox" then obj:Destroy() end
            end
            target.DescendantAdded:Connect(function(newObj)
                if string.lower(newObj.Name) == "hitbox" then newObj:Destroy() end
            end)
        end
        for _, child in ipairs(purchases:GetChildren()) do process(child) end
        purchases.ChildAdded:Connect(function(newChild)
            task.wait(0.05)
            process(newChild)
        end)
    end

    local function DeletePlayerModelsLoop()
        while true do
            for _, name in ipairs(badPlayers) do
                local m = Workspace:FindFirstChild(name)
                if m then m:Destroy() end
            end
            task.wait(1)
        end
    end

    local function RemoveGuiAndSoundsLoop()
        while true do
            local pg = localPlayer and localPlayer:FindFirstChild("PlayerGui")
            if pg then
                local notif = pg:FindFirstChild("Notification")
                if notif then notif:Destroy() end
            end
            local s = ReplicatedStorage:FindFirstChild("Sounds")
            if s and s:FindFirstChild("Sfx") and s.Sfx:FindFirstChild("Warn") then
                s.Sfx.Warn:Destroy()
            end
            task.wait(1)
        end
    end

    local function CloneAndReplaceOtherBases(base)
        if not plotsFolder then return end
        for _, plot in ipairs(plotsFolder:GetChildren()) do
            if plot ~= base then
                local clone = plot:Clone()
                clone.Name = plot.Name .. "_Clone"
                clone.Parent = plotsFolder
                PreserveAnimations(plot, clone)
                plot:Destroy()
            end
        end
    end

    local function HideBadPlayersLoop()
        while task.wait(0.5) do
            -- CoreGui PlayerList / Settings
            local success, scrollList = pcall(function()
                return CoreGui.PlayerList.Children.BodyBackground.ContentFrame.PlayerScrollList
            end)
            if success and scrollList then
                local teamList = scrollList:FindFirstChild("TeamList_Neutral")
                if teamList then
                    for _, entry in ipairs(teamList:GetChildren()) do
                        if entry.Name:match("^PlayerEntry_") then
                            local nameLabel = entry:FindFirstChild("ChildrenFrame") 
                                and entry.ChildrenFrame:FindFirstChild("NameFrame") 
                                and entry.ChildrenFrame.NameFrame:FindFirstChild("PlayerName") 
                                and entry.ChildrenFrame.NameFrame.PlayerName:FindFirstChild("PlayerName")
                            if nameLabel and nameLabel:IsA("TextLabel") then
                                for _, badName in ipairs(badPlayers) do
                                    if string.lower(nameLabel.Text) == string.lower(badName) then
                                        entry:Destroy()
                                        break
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end

    local function CleanRandomModelsLoop()
        local protected = {
            ["Witch"]=true, ["ShopNPCRobuxIdle"]=true, ["ShopNPCCash"]=true, ["Shop"]=true,
            ["RobuxShop"]=true, ["FuseMachine"]=true, ["CraftingMachine"]=true, ["BrainrotTrader"]=true
        }
        local function isRandomID(name)
            return name and name:match("^[%w]+%-[%w]+%-[%w]+%-[%w]+%-[%w]+$") ~= nil
        end
        while task.wait(0.1) do
            for _, obj in ipairs(Workspace:GetChildren()) do
                if obj:IsA("Model") then
                    local name = obj.Name
                    if not protected[name] and not isRandomID(name) and not Players:FindFirstChild(name) then
                        obj:Destroy()
                    end
                end
            end
        end
    end

    -- Start all loops and functions
    task.spawn(function()
        while not plotsFolder do
            plotsFolder = Workspace:FindFirstChild("Plots")
            task.wait(0.1)
        end
        myBase = FindMyBase()
        if myBase then
            DuplicateBaseModelsOnce(myBase)
            DuplicateAnimalPodiumsOnce(myBase)
            cleanHitboxes(myBase)
        end
        CloneAndReplaceOtherBases(myBase)
        task.spawn(DeletePlayerModelsLoop)
        task.spawn(RemoveGuiAndSoundsLoop)
        task.spawn(HideBadPlayersLoop)
        task.spawn(CleanRandomModelsLoop)
    end)
end
